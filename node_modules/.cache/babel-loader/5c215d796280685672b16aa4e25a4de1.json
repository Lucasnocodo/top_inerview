{"ast":null,"code":"import _defineProperty from\"/Users/chenyuda/Documents/top-interview/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/chenyuda/Documents/top-interview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/chenyuda/Documents/top-interview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useRef,useLayoutEffect,useState,memo,useCallback}from'react';import Skeleton from'./Skeleton';import'./Search.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var initSearchState={inputCity:'',inputCountry:''};export default/*#__PURE__*/memo(function Search(_ref){var result=_ref.result,handleSearch=_ref.handleSearch,init=_ref.init,isLoading=_ref.isLoading;console.log('search render');var _useState=useState(initSearchState),_useState2=_slicedToArray(_useState,2),searchData=_useState2[0],setSearchData=_useState2[1];var targetRef=useRef();var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),containerWidth=_useState4[0],setContainerWidth=_useState4[1];useLayoutEffect(function(){if(targetRef.current){setContainerWidth(targetRef.current.offsetWidth);}},[]);var inputCity=searchData.inputCity,inputCountry=searchData.inputCountry;var city=result.city,country=result.country,description=result.description,main_description=result.main_description,humidity=result.humidity,temp_max=result.temp_max,temp_min=result.temp_min,dateTime=result.dateTime;var inputs=[{title:'City',key:'inputCity',value:inputCity},{title:'Country',key:'inputCountry',value:inputCountry}];var resultData=useCallback(function(){return[{title:'Description',unit:'',value:description},{title:'Temperature',unit:'°C',value:temp_min,value2:temp_max},{title:'Humidity',unit:'%',value:humidity},{title:'Time',unit:'',value:dateTime}];},[dateTime,description,humidity,temp_max,temp_min]);var handleInputChange=function handleInputChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setSearchData(function(pre){return _objectSpread(_objectSpread({},pre),{},_defineProperty({},name,value));});};var handleClear=function handleClear(){setSearchData(initSearchState);};var handleKeyDown=function handleKeyDown(e){if(e.key==='Enter'){handleSearch(inputCity,inputCountry);}};var renderResult=useCallback(function(){if(init)return null;if(isLoading)return/*#__PURE__*/_jsx(Skeleton,{});var cod=result.cod,message=result.message;if(cod===200){return/*#__PURE__*/_jsxs(\"div\",{className:\"result-box\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"light\",children:[city,\",\",country]}),/*#__PURE__*/_jsx(\"p\",{className:\"main-description\",children:main_description}),resultData().map(function(_ref2){var title=_ref2.title,unit=_ref2.unit,value=_ref2.value,value2=_ref2.value2;return/*#__PURE__*/_jsxs(\"div\",{className:\"result-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"result-col light\",children:[title,\":\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"result-value\",children:value2?\"\".concat(value).concat(unit,\" ~ \").concat(value2).concat(unit):\"\".concat(value).concat(unit)})]},title);})]});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"err-message\",children:message});}},[city,country,init,isLoading,main_description,result,resultData]);return/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",ref:targetRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-bar\",children:[inputs.map(function(_ref3){var title=_ref3.title,key=_ref3.key,value=_ref3.value;return/*#__PURE__*/_jsx(\"div\",{className:\"search-box\",children:/*#__PURE__*/_jsx(ResposeInput,{title:title,containerWidth:containerWidth,handleInputChange:handleInputChange,value:value,name:key,handleKeyDown:handleKeyDown})},title);}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-box button-box\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleSearch(inputCity,inputCountry);},children:\"Search\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleClear();},children:\"Clear\"})]})]}),renderResult()]});});var ResposeInput=function ResposeInput(_ref4){var containerWidth=_ref4.containerWidth,value=_ref4.value,handleInputChange=_ref4.handleInputChange,handleKeyDown=_ref4.handleKeyDown,name=_ref4.name,title=_ref4.title;return/*#__PURE__*/_jsxs(_Fragment,{children:[containerWidth>600&&/*#__PURE__*/_jsxs(\"span\",{className:\"input-name\",children:[title,\": \"]}),/*#__PURE__*/_jsx(\"input\",{value:value,onChange:function onChange(e){return handleInputChange(e);},name:name,autoFocus:title==='City',onKeyDown:handleKeyDown,placeholder:containerWidth>600?'':title})]});};","map":{"version":3,"sources":["/Users/chenyuda/Documents/top-interview/src/components/Search.jsx"],"names":["React","useRef","useLayoutEffect","useState","memo","useCallback","Skeleton","initSearchState","inputCity","inputCountry","Search","result","handleSearch","init","isLoading","console","log","searchData","setSearchData","targetRef","containerWidth","setContainerWidth","current","offsetWidth","city","country","description","main_description","humidity","temp_max","temp_min","dateTime","inputs","title","key","value","resultData","unit","value2","handleInputChange","e","target","name","pre","handleClear","handleKeyDown","renderResult","cod","message","map","ResposeInput"],"mappings":"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","sourcesContent":["import React, { useRef, useLayoutEffect, useState, memo, useCallback } from 'react';\nimport Skeleton from './Skeleton';\nimport './Search.css'\n\nconst initSearchState = { inputCity: '', inputCountry: '' }\n\nexport default memo(function Search({ result, handleSearch, init, isLoading }) {\n    console.log('search render')\n    const [searchData, setSearchData] = useState(initSearchState)\n    const targetRef = useRef();\n    const [containerWidth, setContainerWidth] = useState(0);\n\n    useLayoutEffect(() => {\n        if (targetRef.current) {\n            setContainerWidth(targetRef.current.offsetWidth);\n        }\n    }, []);\n\n    let { inputCity, inputCountry } = searchData\n    const { city, country, description, main_description, humidity, temp_max, temp_min, dateTime } = result\n    const inputs = [\n        {\n            title: 'City',\n            key: 'inputCity',\n            value: inputCity,\n        },\n        {\n            title: 'Country',\n            key: 'inputCountry',\n            value: inputCountry,\n        },\n    ]\n    const resultData = useCallback(() => [\n        {\n            title: 'Description',\n            unit: '',\n            value: description\n        },\n        {\n            title: 'Temperature',\n            unit: '°C',\n            value: temp_min,\n            value2: temp_max,\n        },\n        {\n            title: 'Humidity',\n            unit: '%',\n            value: humidity\n        },\n        {\n            title: 'Time',\n            unit: '',\n            value: dateTime\n        },\n\n    ], [dateTime, description, humidity, temp_max, temp_min])\n\n    const handleInputChange = (e) => {\n        const { name, value } = e.target\n        setSearchData((pre) => ({ ...pre, [name]: value }))\n    }\n\n    const handleClear = () => {\n        setSearchData(initSearchState)\n    }\n\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter') {\n            handleSearch(inputCity, inputCountry)\n        }\n    }\n\n    const renderResult = useCallback(() => {\n        if (init) return null\n        if (isLoading) return <Skeleton />\n        const { cod, message } = result\n        if (cod === 200) {\n            return (\n                <div className='result-box' >\n                    <span className='light'>{city},{country}</span>\n                    <p className='main-description'>{main_description}</p>\n                    {resultData().map(({ title, unit, value, value2 }) => {\n                        return (\n                            <div className=\"result-item\" key={title}>\n                                <div className='result-col light'>\n                                    {title}:\n                                </div>\n                                <div className='result-value'>\n                                    {value2 ? `${value}${unit} ~ ${value2}${unit}` : `${value}${unit}`}\n                                </div>\n                            </div>\n                        )\n                    })}\n                </div>\n            )\n        } else {\n            return <div className='err-message'>{message}</div>\n        }\n    }, [city, country, init, isLoading, main_description, result, resultData])\n\n    return (\n        <div className='search-container' ref={targetRef} >\n            <div className='search-bar'>\n                {inputs.map(({ title, key, value }) => (\n                    <div className='search-box' key={title}>\n                        <ResposeInput\n                            title={title}\n                            containerWidth={containerWidth}\n                            handleInputChange={handleInputChange}\n                            value={value}\n                            name={key}\n                            handleKeyDown={handleKeyDown}\n                        />\n                    </div>\n\n                ))}\n                <div className='search-box button-box'>\n                    <button onClick={() => handleSearch(inputCity, inputCountry)}>Search</button>\n                    <button onClick={() => handleClear()}>Clear</button>\n                </div>\n            </div>\n            {renderResult()}\n        </div>\n    )\n})\n\nconst ResposeInput = ({ containerWidth, value, handleInputChange, handleKeyDown, name, title }) => (\n    <>\n        {containerWidth > 600 &&\n            <span className='input-name'>{title}: </span>\n        }\n        <input\n            value={value}\n            onChange={(e) => handleInputChange(e)}\n            name={name}\n            autoFocus={title === 'City'}\n            onKeyDown={handleKeyDown}\n            placeholder={containerWidth > 600 ? '' : title}\n        />\n    </>\n)\n"]},"metadata":{},"sourceType":"module"}